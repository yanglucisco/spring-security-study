server:
  port: 10000
spring:
  application:
    name: gateway
  cloud:
    gateway:
      routes:
        - id: front
          uri: http://127.0.0.1:11002
          predicates:
           - Path=/,/*.css,/*.js,/home.html,/index.html,/test.html,/favicon.ico, /fronttest,/index1.html,/index2.html
        - id: aliyun_route
          uri: https://www.aliyun.com/
          predicates:
            - Path=/product/**
        - id: articles
          uri: http://127.0.0.1:8090
          predicates:
           - Path=/articles/**
          filters:
           - StripPrefix=1        # 转发前去掉第一层路径 /client
           - name: AddStaticTokenScope # 使用自定义过滤器添加指定令牌
        - id: client
          uri: http://127.0.0.1:8080
          predicates:
           - Path=/client/**
          filters:
           - StripPrefix=1        # 转发前去掉第一层路径 /client
        - id: client1
          uri: http://127.0.0.1:8081
          predicates:
           - Path=/client1/**
          filters:
           - StripPrefix=1        # 转发前去掉第一层路径 /client1
           - name: AddStaticTokenScope # 使用自定义过滤器添加指定令牌
        - id: test_route
          uri: http://auth-server:9000
          predicates:
           - Path=/oauth2/**
        - id: test_route1
          uri: http://www.sina.com.cn
          predicates:
           - Path=/sina/**
        - id: test_route2
          uri: http://auth-server:9000
          predicates:
           - Path=/test/**
        - id: resourcerole
          uri: http://127.0.0.1:8091
          predicates:
           - Path=/resourcerole/**
          filters:
           - name: AddStaticTokenRole # 使用自定义过滤器添加指定令牌
        - id: resourcescope
          uri: http://127.0.0.1:8091
          predicates:
           - Path=/resourcescope/**
          filters:
           - name: AddStaticTokenScope # 使用自定义过滤器添加指定令牌
        - id: resourcerole0
          uri: http://127.0.0.1:8090
          predicates:
           - Path=/resourcerole0/**
          filters:
           - name: AddStaticTokenRole # 使用自定义过滤器添加指定令牌
        - id: resourcescope0
          uri: http://127.0.0.1:8090
          predicates:
           - Path=/resourcescope0/**
          filters:
           - name: AddStaticTokenScope # 使用自定义过滤器添加指定令牌
  security:
    oauth2:
      client:
        registration:
          gateway:
            provider: spring
            client-id: gateway
            client-secret: gatewaysecret
            authorization-grant-type: authorization_code
            redirect-uri: "http://127.0.0.1:10000/login/oauth2/code/{registrationId}"
            scope: 
             - openid
            client-name: gateway
          gateway-scope:
            provider: spring
            client-id: gateway
            client-secret: gatewaysecret
            authorization-grant-type: client_credentials
            redirect-uri: "http://127.0.0.1:10000/login/oauth2/code/{registrationId}"
            scope: 
             - articles.read
            client-name: gateway
        provider:
          spring:
            issuer-uri: http://auth-server:9000
  data:
    redis:
      host: localhost  # 你的Redis服务器地址
      port: 6380       # 你的Redis服务器端口
      # 如果Redis有密码，需要配置
      # password: your-redis-password
      # 可以选择数据库编号，默认为0
      # database: 0
      lettuce:
        pool:
          max-active: 8   # 连接池最大连接数
          max-idle: 8     # 连接池最大空闲连接数
          min-idle: 0     # 连接池最小空闲连接数
  session:
    store-type: redis
    timeout: 120m
    redis:
      namespace: polar:edge

logging:
  level:
    '[org.springframework.cloud.gateway]': DEBUG  # 开启网关核心日志
    '[org.springframework.http.server.reactive]': DEBUG  # 打印HTTP请求细节[2](@ref)[8](@ref)
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"  # 自定义日志格式[10](@ref)